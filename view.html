<!DOCTYPE html>
<html lang="ru">

<head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>–ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ - whynotusethis.website</title>

     <!-- Tailwind CSS -->
     <script src="https://cdn.tailwindcss.com"></script>

     <!-- Google Fonts: Inter -->
     <link rel="preconnect" href="https://fonts.googleapis.com">
     <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
     <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap" rel="stylesheet">

     <style>
          body {
               font-family: 'Inter', sans-serif;
               background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #0a0a0a 100%);
               color: #e0e0e0;
               min-height: 100vh;
          }

          .glass-effect {
               background: rgba(16, 16, 16, 0.8);
               backdrop-filter: blur(20px);
               -webkit-backdrop-filter: blur(20px);
               border: 1px solid rgba(255, 255, 255, 0.1);
          }

          .gradient-text {
               background: linear-gradient(90deg, #4f46e5, #db2777);
               -webkit-background-clip: text;
               -webkit-text-fill-color: transparent;
          }

          .timer-ring {
               stroke-dasharray: 283;
               stroke-dashoffset: 0;
               transition: stroke-dashoffset 1s linear;
          }

          @keyframes pulse-glow {

               0%,
               100% {
                    box-shadow: 0 0 20px rgba(219, 39, 119, 0.3);
               }

               50% {
                    box-shadow: 0 0 40px rgba(219, 39, 119, 0.6);
               }
          }

          .pulse-warning {
               animation: pulse-glow 1s ease-in-out infinite;
          }

          @keyframes fadeIn {
               from {
                    opacity: 0;
                    transform: translateY(20px);
               }

               to {
                    opacity: 1;
                    transform: translateY(0);
               }
          }

          .fade-in {
               animation: fadeIn 0.5s ease-out;
          }

          .content-box {
               word-break: break-word;
               white-space: pre-wrap;
          }

          /* Particle background */
          .particles {
               position: fixed;
               top: 0;
               left: 0;
               width: 100%;
               height: 100%;
               pointer-events: none;
               overflow: hidden;
               z-index: -1;
          }

          .particle {
               position: absolute;
               width: 2px;
               height: 2px;
               background: rgba(79, 70, 229, 0.5);
               border-radius: 50%;
               animation: float 15s infinite;
          }

          @keyframes float {

               0%,
               100% {
                    transform: translateY(100vh) rotate(0deg);
                    opacity: 0;
               }

               10% {
                    opacity: 1;
               }

               90% {
                    opacity: 1;
               }

               100% {
                    transform: translateY(-100vh) rotate(720deg);
                    opacity: 0;
               }
          }
     </style>
</head>

<body class="antialiased flex items-center justify-center p-4">
     <!-- Particles background -->
     <div class="particles" id="particles"></div>

     <!-- Main container -->
     <div class="max-w-2xl w-full fade-in">
          <!-- Loading state -->
          <div id="loading-state" class="glass-effect rounded-3xl p-12 text-center">
               <div
                    class="inline-block w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin mb-4">
               </div>
               <p class="text-gray-400">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞...</p>
          </div>

          <!-- Error state -->
          <div id="error-state" class="hidden glass-effect rounded-3xl p-12 text-center">
               <div class="text-6xl mb-4">üí®</div>
               <h1 class="text-2xl font-bold text-gray-200 mb-2">–ö–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω</h1>
               <p id="error-message" class="text-gray-400 mb-6">–ö–æ–Ω—Ç–µ–Ω—Ç –±—ã–ª —É–¥–∞–ª—ë–Ω –∏–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç</p>
               <a href="/"
                    class="inline-block px-6 py-3 bg-indigo-600 hover:bg-indigo-700 rounded-xl font-semibold transition-colors">
                    –ù–∞ –≥–ª–∞–≤–Ω—É—é
               </a>
          </div>

          <!-- Content state -->
          <div id="content-state" class="hidden">
               <!-- Timer header -->
               <div id="timer-section" class="hidden mb-6">
                    <div class="glass-effect rounded-2xl p-4 flex items-center justify-between pulse-warning">
                         <div class="flex items-center gap-3">
                              <svg class="w-8 h-8" viewBox="0 0 100 100">
                                   <circle cx="50" cy="50" r="45" fill="none" stroke="rgba(255,255,255,0.1)"
                                        stroke-width="8" />
                                   <circle id="timer-circle" cx="50" cy="50" r="45" fill="none" stroke="#db2777"
                                        stroke-width="8" class="timer-ring" transform="rotate(-90 50 50)" />
                              </svg>
                              <div>
                                   <p class="text-sm text-gray-400">–°–∞–º–æ—É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑</p>
                                   <p id="timer-display" class="text-xl font-bold gradient-text">--:--</p>
                              </div>
                         </div>
                         <div class="text-right">
                              <span class="text-xs text-gray-500">–ü–æ—Å–ª–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç —É–¥–∞–ª—ë–Ω</span>
                         </div>
                    </div>
               </div>

               <!-- Content card -->
               <div class="glass-effect rounded-3xl overflow-hidden">
                    <!-- Header -->
                    <div class="p-6 border-b border-gray-800">
                         <div class="flex items-center justify-between">
                              <h1 class="text-xl font-bold gradient-text">–í—Ä–µ–º–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç</h1>
                              <span id="content-type-badge"
                                   class="px-3 py-1 rounded-full text-sm bg-indigo-600/20 text-indigo-400"></span>
                         </div>
                    </div>

                    <!-- Content body -->
                    <div class="p-6">
                         <!-- Text content -->
                         <div id="text-content" class="hidden">
                              <p id="content-text" class="content-box text-lg text-gray-200 leading-relaxed"></p>
                         </div>

                         <!-- Link content -->
                         <div id="link-content" class="hidden">
                              <a id="content-link" href="#" target="_blank" rel="noopener noreferrer"
                                   class="block p-4 rounded-xl bg-indigo-600/10 border border-indigo-600/30 hover:bg-indigo-600/20 transition-colors">
                                   <div class="flex items-center gap-3">
                                        <svg class="w-6 h-6 text-indigo-400" fill="none" stroke="currentColor"
                                             viewBox="0 0 24 24">
                                             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                  d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                                        </svg>
                                        <span id="link-text" class="text-indigo-400 break-all"></span>
                                   </div>
                              </a>
                         </div>

                         <!-- File/Image content -->
                         <div id="file-content" class="hidden">
                              <div class="space-y-4">
                                   <div id="image-preview" class="hidden">
                                        <img id="content-image" src="" alt="–ó–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"
                                             class="max-w-full rounded-xl mx-auto shadow-2xl">
                                   </div>
                                   <button id="download-btn"
                                        class="w-full flex items-center justify-center gap-3 p-4 rounded-xl bg-pink-600/20 border border-pink-600/30 hover:bg-pink-600/30 transition-colors text-pink-400">
                                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                             <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                  d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                        </svg>
                                        <span id="file-name">–°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª</span>
                                   </button>
                              </div>
                         </div>
                    </div>

                    <!-- Footer -->
                    <div class="p-6 border-t border-gray-800 flex items-center justify-between">
                         <span id="created-at" class="text-sm text-gray-500"></span>
                         <a href="/" class="text-sm text-indigo-400 hover:text-indigo-300 transition-colors">
                              –°–æ–∑–¥–∞—Ç—å —Å–≤–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç ‚Üí
                         </a>
                    </div>
               </div>
          </div>
     </div>

     <script>
          const API_BASE = '/api';
          let timerInterval = null;
          let totalSeconds = 0;
          let isBurnAfterRead = false;

          // Get UUID from URL
          function getUUID() {
               const path = window.location.pathname;
               const match = path.match(/\/view\/([a-f0-9-]+)/i);
               return match ? match[1] : null;
          }

          // Create particles
          function createParticles() {
               const container = document.getElementById('particles');
               for (let i = 0; i < 50; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.animationDelay = Math.random() * 15 + 's';
                    particle.style.animationDuration = (10 + Math.random() * 10) + 's';
                    container.appendChild(particle);
               }
          }

          // Format time
          function formatTime(seconds) {
               if (seconds <= 0) return '00:00';
               const mins = Math.floor(seconds / 60);
               const secs = seconds % 60;
               return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
          }

          // Update timer display
          function updateTimer(remaining) {
               const display = document.getElementById('timer-display');
               const circle = document.getElementById('timer-circle');

               display.textContent = formatTime(remaining);

               // Update circle progress
               const progress = totalSeconds > 0 ? (remaining / totalSeconds) : 0;
               const offset = 283 * (1 - progress);
               circle.style.strokeDashoffset = offset;

               // Last 10 seconds - change color
               if (remaining <= 10) {
                    display.classList.add('text-red-500');
                    display.style.webkitTextFillColor = '#ef4444';
               }
          }

          // Start countdown timer
          function startTimer(seconds) {
               totalSeconds = seconds;
               let remaining = seconds;

               document.getElementById('timer-section').classList.remove('hidden');
               updateTimer(remaining);

               timerInterval = setInterval(() => {
                    remaining--;
                    updateTimer(remaining);

                    if (remaining <= 0) {
                         clearInterval(timerInterval);
                         showExpired();
                    }
               }, 1000);
          }

          // Show expired state
          function showExpired() {
               document.getElementById('content-state').classList.add('hidden');
               document.getElementById('error-state').classList.remove('hidden');
               document.getElementById('error-message').textContent = '–ö–æ–Ω—Ç–µ–Ω—Ç –±—ã–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—ë–Ω';
          }

          // Show error
          function showError(message) {
               document.getElementById('loading-state').classList.add('hidden');
               document.getElementById('error-state').classList.remove('hidden');
               document.getElementById('error-message').textContent = message;
          }

          // Show content
          function showContent(data) {
               document.getElementById('loading-state').classList.add('hidden');
               document.getElementById('content-state').classList.remove('hidden');

               const { type, content, fileName, hasFile, autoDelete, burnAfterRead, ipRestriction, remainingSeconds, createdAt } = data;

               isBurnAfterRead = burnAfterRead;

               // Type badge
               const typeBadge = document.getElementById('content-type-badge');
               const typeLabels = { text: '–¢–µ–∫—Å—Ç', link: '–°—Å—ã–ª–∫–∞', file: '–§–∞–π–ª' };
               let badgeText = typeLabels[type] || type;

               // Add burn after read indicator
               if (burnAfterRead) {
                    badgeText = 'üî• ' + badgeText;
                    typeBadge.classList.add('bg-red-600/20', 'text-red-400');
                    typeBadge.classList.remove('bg-indigo-600/20', 'text-indigo-400');
               }
               typeBadge.textContent = badgeText;

               // Show appropriate content type
               if (type === 'text') {
                    document.getElementById('text-content').classList.remove('hidden');
                    document.getElementById('content-text').textContent = content;
               } else if (type === 'link') {
                    document.getElementById('link-content').classList.remove('hidden');
                    document.getElementById('content-link').href = content;
                    document.getElementById('link-text').textContent = content;
               } else if (type === 'file' || hasFile) {
                    document.getElementById('file-content').classList.remove('hidden');
                    document.getElementById('file-name').textContent = `–°–∫–∞—á–∞—Ç—å: ${fileName}`;

                    // If it's an image, show preview
                    if (fileName && /\.(jpg|jpeg|png|gif|webp)$/i.test(fileName)) {
                         const uuid = getUUID();
                         document.getElementById('image-preview').classList.remove('hidden');
                         document.getElementById('content-image').src = `${API_BASE}/content/${uuid}/download`;
                    }

                    // Download button
                    document.getElementById('download-btn').addEventListener('click', () => {
                         const uuid = getUUID();
                         window.location.href = `${API_BASE}/content/${uuid}/download`;
                    });
               }

               // Also show text if file has text content
               if (hasFile && content) {
                    document.getElementById('text-content').classList.remove('hidden');
                    document.getElementById('content-text').textContent = content;
               }

               // Created date
               if (createdAt) {
                    const date = new Date(createdAt * 1000);
                    document.getElementById('created-at').textContent = `–°–æ–∑–¥–∞–Ω–æ: ${date.toLocaleString('ru-RU')}`;
               }

               // Burn after read warning
               if (burnAfterRead) {
                    const warningDiv = document.createElement('div');
                    warningDiv.className = 'mb-6 p-4 bg-red-900/30 border border-red-600/30 rounded-2xl text-center';
                    warningDiv.innerHTML = `
                    <p class="text-red-400 font-medium">üî• –≠—Ç–æ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç —É–∂–µ —É–¥–∞–ª—ë–Ω</p>
                    <p class="text-sm text-gray-400 mt-1">–í—ã –≤–∏–¥–∏—Ç–µ –µ–≥–æ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑. –ü–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ–Ω –∏—Å—á–µ–∑–Ω–µ—Ç –Ω–∞–≤—Å–µ–≥–¥–∞.</p>
                `;
                    document.getElementById('content-state').insertBefore(warningDiv, document.getElementById('content-state').firstChild);
               }

               // Start timer if auto-delete is enabled
               if (autoDelete && remainingSeconds !== null) {
                    startTimer(remainingSeconds);
               }
          }

          // Load content
          async function loadContent() {
               const uuid = getUUID();

               if (!uuid) {
                    showError('–ù–µ–≤–µ—Ä–Ω–∞—è —Å—Å—ã–ª–∫–∞');
                    return;
               }

               try {
                    const response = await fetch(`${API_BASE}/content/${uuid}`);
                    const data = await response.json();

                    if (!response.ok || !data.success) {
                         showError(data.error || '–ö–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω');
                         return;
                    }

                    showContent(data.content);
               } catch (error) {
                    console.error('Error loading content:', error);
                    showError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞');
               }
          }

          // Initialize
          document.addEventListener('DOMContentLoaded', () => {
               createParticles();
               loadContent();
          });
     </script>
</body>

</html>